<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    
    <body>
        
        <div class="row">
                
        <!-- COLUMN -->
        <div th:fragment="leftcolumn" class="col-1 d-none d-sm-block" id="leftcolumn"></div>
        
        
        
        <!-- HEADER INFO -->
        <div th:fragment="headers">
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
            <!-- Favicon-->
            <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
            
            
            <!-- Google fonts-->
            <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
            <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />

            <!-- SimpleLightbox plugin CSS-->
            <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />

            
            <!-- BOOTSTRAP -->
            <!-- Bootstrap CSS -->
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
            
            <!-- Bootstrap Icons-->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
            
            <!-- CUSTOM CSS -->
            <link href="css/styles.css" rel="stylesheet" />
        </div>
        
        
        
        
        <!-- CAROUSEL -->
        <div id="carousel" class="carousel slide carousel-fade" data-bs-ride="carousel" th:fragment="carousel">
            <div class="carousel-inner">
              <div class="carousel-item" data-bs-interval="5000">
                <img src="../assets/img/products/categories/harper-sunday-uRuF9ABj0NY-unsplash.jpg" href="/Accessories" class="d-block w-100" alt="Accessories">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Accessories</h5>
                    <p>New inventory added to accessories in Dublin.</p>
                </div>
              </div>
              <div class="carousel-item active" data-bs-interval="5000">
                <img src="../assets/img/products/categories/lan-deng-quddu_dZKkQ-unsplash.jpg" href="/clothes" class="d-block w-100" alt="Clothes">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Trousers</h5>
                    <p>Special offers on select trousers in the South East.</p>
                </div>
              </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        <!-- COLUMN -->
        <div th:fragment="rightcolumn" class="col-1 d-none d-sm-block" id="rightcolumn"></div>
        
        
        <!-- FULFILMENT CARD -->
        <th:block th:fragment="fulfilment-card">
            <div class="col" id="infocard-container" th:with="date = ${subOrder.order.getDate()}">
                <h2 th:text="'For Order #: ' + ${subOrder.order.id}"></h2>
                <h3 th:text="'SubOrder #: ' + ${subOrder.id}"></h3>
                <h6 th:unless="${date == null}" th:text=" 'Ordered: ' + ${subOrder.order.getDate()} + ' at ' + ${subOrder.order.getTime()} "> </h6>
                <h5 th:text="'Customer Name: ' + ${subOrder.order.customer.firstName} + ' ' + ${subOrder.order.customer.surname}"> </h5>
                <p class="customer-address" th:text="'Address: ' + ${subOrder.order.customer.getAddress().getFullAddress()}"> </p>
                <h6 th:text="'Expected driver: ' + ${subOrder.order.driver.firstName} + ' ' + ${subOrder.order.driver.surname}"> </h6>
                <div class="row row-cols-1 row-cols-md-2 g-4">
                    <th:block th:each="subOrderItem : ${subOrder.items}">
                        <div class="col-lg-4 mb-3 d-flex align-items-stretch">
                            <div class="card mx-auto">

                                <div class="card-body">
                                    <div class="row">
                                        <!-- CHECKBOX -->
                                        <div class="col-1">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                            </div>
                                        </div>


                                        <!-- TITLE -->
                                        <div class="col">
                                            <h5 class="card-title" th:text="${subOrderItem.product.productName}"></h5>
                                        </div>


                                    </div>

                                    <!-- QUANTITY -->
                                    <h5 th:text="x + ${subOrderItem.quantity}"></h5>
                                        <div class ="button-wrapper">
                                            <a class="btn btn-primary mr-1" th:href="'productpage?identifier='+${subOrderItem.product.getIdentifier()}">See Details</a>
                                            <a class="btn btn-danger" th:href="'productpage?identifier='+${subOrderItem.product.getIdentifier()}">Cancel Item</a>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </th:block>
                </div>
            </div>

            <!-- MARK AS READY -->
            <div class="row">
                <div class="col">
                    <button class="btn btn-warning" style="float:right" th:attr="onclick=|confirmMarkAsReady('${subOrder.id}','${subOrder.order.id}')|">Mark as Ready</button>
                </div>
            </div>
            <br/>
        </th:block> <!--/* END OF FULFILMENT-CARD */-->
        
        
        
        
        <th:block th:fragment="delivery-card">
            <div class="infocard-container">
                <!-- ORDER INFO -->
                <div class="col">
                    <div class="row">
                        <h2 th:text="'Order ID : ' + ${order.id}"></h2>
                    </div>

                    <!-- SUPPLIER ADDRESS -->
                    <div class="row">
                        <div class="col">
                            <b class="header"> Suppliers: </b>
                            <br/>
                            <div class="supplier_content">
                                <th:block th:each="supplier : ${order.getSuppliers()}" >
                                    <b th:text="${supplier.storeName}"></b>
                                    <br/>
                                    <b th:text="${supplier.getAddress().addressLine1}"></b>
                                    <br/>
                                    <b th:text="${supplier.getAddress().addressLine2}"></b>
                                    <br/>
                                    <b th:text="${supplier.getAddress().city}"></b>
                                    <br/>
                                    <b th:text="${supplier.getAddress().district}"></b>
                                    <br/>
                                    <b th:text="${supplier.getAddress().postcode}"></b>
                                    <br/>
                                    <br/>
                                </th:block>
                            </div>
                            <!-- add some space after each supplier -->
                        </div>

                    <!-- ORDER PRODUCTS -->
                    <div class="col">
                        <b class="header"> Contents: </b>
                        <br/>
                        <div class="product_contents">
                            <th:block th:each="orderItem : ${order.getItems()}" >
                                <th:block th:each="product : ${orderItem.getProduct()}" >

                                    <b><span th:text="${product.getProductName} + ' x ' +  ${orderItem.getQuantity}"></b>
                                <br/>
                                <br/>
                            </th:block>
                        </div>
                    </div>

                    <!-- CUSTOMER ADDRESS -->
                    <div class="col">
                        <b class="header"> To: </b>
                        <br/>
                        <span>
                            <b th:text="${order.customer.firstName}"></b>
                            <b th:text="${order.customer.surname}"></b>
                        </span>
                        <br/>
                            <b th:text="${order.customer.address.addressLine1}"></b>
                        <br/>
                            <b th:text="${order.customer.address.addressLine2}"></b>
                        <br/>
                            <b th:text="${order.customer.address.city}"></b>
                        <br/>
                            <b th:text="${order.customer.address.district}"></b>
                        <br/>
                            <b th:text="${order.customer.address.postcode}"></b>
                        <br/>
                    </div>
                    
                    <!-- Google Maps API -->
                    <div class="col" th:with="customerAddress = ${order.getCustomer().getAddress().getFullAddress()}">
                        <iframe
                        width="450"
                        height="250"
                        frameborder="0"
                        style="border:0"
                        allowfullscreen
                        referrerpolicy="no-referrer-when-downgrade"
                            th:src="${
                                'https://www.google.com/maps/embed/v1/directions?key=AIzaSyALT3yXsFTUtCLKH_zNEW8YgC_4D37lsek
                                &origin=' + driverAddress +
                                '&destination=' + customerAddress +
                                '&avoid=tolls'}">
                      </iframe>
                    </div>

                    <div class="col">
                        <button class="button_MarkAsDelivered" th:attr="onclick=|confirmMarkAsDelivered('${order.id}')|">Mark as Delivered</button>
                    </div>

                    </div>
                </div>
            </div>
            <br/>
        </th:block>  <!--/* END OF DELIVERY-CARD */-->
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <!-- FOOTER -->
        <div th:fragment="footer">
            <div class="row" id="footer">
                
            </div>
            
            
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        </div>
    </body>
</html>
